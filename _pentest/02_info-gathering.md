---
title: "Information Gathering"
permalink: /pentest/02_info-gathering/
toc: true
---

### Information Gathering/Target Mapping
##### Reconnaissance
  - Gather as much as you can
  - Passive/OSINT
    - ip addresses
    - nslookup, mail server info, mx records, internet registries, BGP information, DNS information
    - email addresses, contact information
    - org chart, hierarchy
    - any public datasets available
    - DNS reverse lookups
    - IP reverse lookups

    - e-mail id formats
    - Network Maps
    - Locations, google maps, google hacking database
    - whois
    - shodan
        - net
        - city
        - country
        - before
        - port
        - os
        - after
    - censys
    - GHDB
    - https://centralops.net/co/
    - ssl/TLS Certificates
      - crt.sh



#### Active
- netdiscover -r 192.168.1.1/24
- arp-scan -l
- whatweb
- nikto
- [one two punch](https://github.com/superkojiman/onetwopunch)
- [Reconnitre](https://github.com/codingo/Reconnoitre)
- masscan
  - p : ports
  - banners : banner information
  - rate : number of packets
- Exiftool
- Binwalk
- enum4linux
- CMS
  - CMSmap
  - Droopescan
  - wpscan
  - Joomscan
- ssl : sslyze
- openvas
- SQL map
- Nessus/Tenable
- Maltego
- foca
- recong-ng
- the harvester
 - nc
    - nc example_domain.com 80
 - ncat
- zmap
- unicornscan
##### Network Baselines
- [pbnj](http://pbnj.sourceforge.net)
- ndiff, nmap suite
##### NMAP
- ``` quick recon : nmap -Pn -F -sSU -T5 -oX /root/basic_scan IP_Range.xml | grep -v 'filtered|closed' > /root/quick_recon.txt ```
- ``` all ports UDP + TCP per host : nmap -Pn -sSU -T4 -p1-65535 -oX /root/complete_scan.xml ip_addr | grep -v 'filtered|closed' ```
- ``` handy command to covert namp xml to html xsltproc nmap_output_file.xml -o nmap_output_file.html ```
- NMAP scritpitng engine(NSE)
- vv : verbose
- sS : TCP Sync scan
- A : aggressive scan
- p : port range
- oA : output in all formats , grepable, normal, xml
- sA : ACK Scan
- sP : Ping scan
- sR : RPC Scan
- sV : service version
- sT : TCP scan
- sU : UDP scan
- sN : Null Scan
--spoof-mac : spoofing mac
- T (0-5) : Timing
- sC : scripts
  - namp -script-updatedb
- max-hostgroup
- max -paralleism
- max -retries
- D : decoys

##### Port Knocking
##### DNS
- dig
   - dig +qr ex:domain_name.com any
- nslookup
- dnsenum
- dnsrecon
- dnsmap
- dnszone transfers
- reverse dns lookup
- theharvester
  - theharvester -d demoodomain.com -b bing
- fierce -dns example_domain.com
  - wordlist : custom wordlist

##### SNMP
- Simple Network Management Protocol
- onesixtyone

##### SMTP
- https://pentestlab.blog/2012/11/20/smtp-user-enumeration/

##### 139
- smbclient
  - smbclient - L ipaddress -N

##### LLMNR
###### [Responder](https://github.com/SpiderLabs/Responder)
- https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/
- https://www.4armed.com/blog/llmnr-nbtns-poisoning-using-responder/
- https://www.blackhillsinfosec.com/how-to-disable-llmnr-why-you-want-to/
- https://www.sternsecurity.com/blog/local-network-attacks-llmnr-and-nbt-ns-poisoning

#### Pass The hash
- these attacks helpful when pentester to reauthenticate using username and NTLM/LM hash



##### Compliance Testing
- [Lynis](https://cisofy.com/lynis/)
- [Tiger](https://www.nongnu.org/tiger/)
- [OpenVas](http://www.openvas.org/)
- [CIS, Center for Internet Security](https://www.cisecurity.org/cis-benchmarks/)
- [STIG (Security Technical Implementation Guide)](https://www.stigviewer.com/stigs)


#### References
- http://www.0daysecurity.com/penetration-testing/enumeration.html
- https://pen-testing.sans.org/blog/2013/10/08/nmap-cheat-sheet-1-0/
- [SAN's nmap cheat sheet](https://blogs.sans.org/pen-testing/files/2013/10/NmapCheatSheetv1.1.pdf)

<p align="center"><img src="https://raw.githubusercontent.com/mohareti/cyberlab/master/assets/images/InfoGathering.jpg" width="500" height="600"></p>
